<p-card>
  <ng-template pTemplate="header">
    <div class="bg-blue-600 text-white p-4">
      <h2 class="text-xl font-bold m-0">{{ pila ? 'Editar Pila' : 'Nueva Pila' }}</h2>
    </div>
  </ng-template>

  <form [formGroup]="pilaForm" (ngSubmit)="onSubmit()">
    <!-- Sede -->
    <div class="mb-4">
      <label for="sede" class="block text-sm font-medium text-gray-700 mb-2">
        Sede <span class="text-red-500">*</span>
      </label>
      <p-select
        id="sede"
        formControlName="sedeId"
        [options]="sedes"
        optionLabel="nombre"
        optionValue="id"
        placeholder="Seleccione una sede"
        styleClass="w-full">
      </p-select>
      <small *ngIf="sedeId?.invalid && sedeId?.touched" class="text-red-600">
        La sede es requerida
      </small>
    </div>

    <!-- Edificio -->
    <div class="mb-4">
      <label for="edificio" class="block text-sm font-medium text-gray-700 mb-2">
        Edificio <span class="text-red-500">*</span>
      </label>
      <p-select
        id="edificio"
        formControlName="edificioId"
        [options]="edificiosFiltrados"
        optionLabel="nombre"
        optionValue="id"
        placeholder="Seleccione un edificio"
        styleClass="w-full"
        [disabled]="!pilaForm.get('sedeId')?.value">
      </p-select>
      <small *ngIf="edificioId?.invalid && edificioId?.touched" class="text-red-600">
        El edificio es requerido
      </small>
    </div>

    <!-- C칩digo de Pila -->
    <div class="mb-6">
      <label for="codigo" class="block text-sm font-medium text-gray-700 mb-2">
        C칩digo de Pila <span class="text-red-500">*</span>
      </label>
      <input
        pInputText
        id="codigo"
        formControlName="codigo"
        placeholder="Ej: EDF-A-P01"
        class="w-full" />
      <small *ngIf="codigo?.invalid && codigo?.touched" class="text-red-600">
        El c칩digo es requerido (m치x. 50 caracteres)
      </small>
    </div>

    <!-- Error Message -->
    <div *ngIf="errorMessage" class="mb-4">
      <p-message severity="error" [text]="errorMessage" styleClass="w-full"></p-message>
    </div>

    <!-- Botones -->
    <div class="flex gap-3">
      <p-button
        type="submit"
        [disabled]="loading"
        [label]="loading ? 'Guardando...' : 'Guardar'"
        icon="pi pi-save"
        styleClass="flex-1"
        severity="primary">
      </p-button>

      <p-button
        type="button"
        (click)="onCancel()"
        label="Cancelar"
        icon="pi pi-times"
        styleClass="flex-1"
        severity="secondary">
      </p-button>
    </div>
  </form>
</p-card>
