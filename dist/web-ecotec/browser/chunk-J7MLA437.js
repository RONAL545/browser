import{a as V}from"./chunk-M7H5KQJM.js";import{a as Y,b as $}from"./chunk-WCFAM2EP.js";import{a as E}from"./chunk-TXZO4CUN.js";import{d as O}from"./chunk-FLR6VCGG.js";import{a as R,b as B}from"./chunk-OHRZ6MUE.js";import{a as q,b as W}from"./chunk-NLIBM6IL.js";import{K as H,L as U,c as I,d as f,f as D,g as F,i as L,j as z,k as T,m as N,o as j,q as A,r as G}from"./chunk-T3CWT4SN.js";import{ra as S}from"./chunk-VKVIFJLB.js";import{a as k}from"./chunk-H7Z7H6FO.js";import{$a as r,Bb as l,La as C,Q as c,Qa as p,V as w,W as b,ab as i,bb as e,cb as s,jb as M,lb as u,nb as d,ra as v,rc as P,ta as x,va as a,wc as y}from"./chunk-BZMIPBVR.js";import{d as _}from"./chunk-4CLCTAJ7.js";function Q(o,n){if(o&1&&s(0,"p-message",39),o&2){let t=d(2);r("text",t.errorMessage)}}function X(o,n){o&1&&(i(0,"span"),l(1,"El email o DNI es requerido"),e())}function Z(o,n){o&1&&(i(0,"span"),l(1,"Debe ser un email v\xE1lido o DNI de 8 d\xEDgitos"),e())}function tt(o,n){if(o&1&&(i(0,"small",40),p(1,X,2,0,"span",41)(2,Z,2,0,"span",41),e()),o&2){let t=d(2);a(),r("ngIf",t.identifier==null||t.identifier.errors==null?null:t.identifier.errors.required),a(),r("ngIf",t.identifier==null||t.identifier.errors==null?null:t.identifier.errors.emailOrDni)}}function et(o,n){o&1&&(i(0,"span"),l(1,"La contrase\xF1a es requerida"),e())}function nt(o,n){o&1&&(i(0,"span"),l(1,"La contrase\xF1a debe tener al menos 6 caracteres"),e())}function it(o,n){if(o&1&&(i(0,"small",40),p(1,et,2,0,"span",41)(2,nt,2,0,"span",41),e()),o&2){let t=d(2);a(),r("ngIf",t.password==null||t.password.errors==null?null:t.password.errors.required),a(),r("ngIf",t.password==null||t.password.errors==null?null:t.password.errors.minlength)}}function ot(o,n){if(o&1){let t=M();i(0,"div",13)(1,"div",14),s(2,"div",15),e(),i(3,"div",16)(4,"div",17)(5,"div",18)(6,"h1",19),l(7,"Sistema ECOTEC"),e(),i(8,"p",20),l(9,"Gesti\xF3n de Residuos"),e()(),i(10,"div",21)(11,"div",22),s(12,"img",23),e(),i(13,"form",24),u("ngSubmit",function(){w(t);let g=d();return b(g.onSubmit())}),p(14,Q,1,1,"p-message",25),i(15,"div",26)(16,"label",27),l(17," Email o DNI "),e(),i(18,"span",28),s(19,"i",29)(20,"input",30),e(),p(21,tt,3,2,"small",31),e(),i(22,"div",26)(23,"label",32),l(24," Contrase\xF1a "),e(),i(25,"span",33),s(26,"i",34)(27,"p-password",35),e(),p(28,it,3,2,"small",31),e(),s(29,"p-button",36),i(30,"div",37)(31,"p"),l(32,"\xBFOlvidaste tu contrase\xF1a? "),i(33,"a",38),l(34,"Contacta al administrador"),e()()()()()()()()}if(o&2){let t=d();a(13),r("formGroup",t.loginForm),a(),r("ngIf",t.errorMessage),a(7),r("ngIf",t.submitted&&(t.identifier==null?null:t.identifier.invalid)),a(6),r("toggleMask",!0)("feedback",!1),a(),r("ngIf",t.submitted&&(t.password==null?null:t.password.invalid)),a(),r("loading",t.loading)("disabled",t.loading),a(4),r("href",t.adminWhatsappUrl,v)}}var J=class o{fb=c(N);authService=c(E);router=c(O);particlesService=c(V);loginForm;loading=!1;errorMessage="";submitted=!1;resizeDebounce;adminWhatsappUrl=`https://wa.me/${k.adminWhatsapp}`;constructor(){this.loginForm=this.fb.group({identifier:["",[f.required,this.emailOrDniValidator]],password:["",[f.required,f.minLength(6)]]})}emailOrDniValidator(n){if(!n.value)return null;let t=n.value.toString().trim(),g=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),K=/^\d{8}$/.test(t);return g||K?null:{emailOrDni:!0}}onResize(n){clearTimeout(this.resizeDebounce),this.resizeDebounce=setTimeout(()=>{this.particlesService.destroyParticles("tsparticles-login-bg"),this.initializeParticles()},250)}ngOnInit(){this.initializeParticles()}ngOnDestroy(){this.particlesService.destroyParticles("tsparticles-login-bg")}initializeParticles(){return _(this,null,function*(){try{let n=window.innerWidth<1200;if(yield this.particlesService.initializeParticlesEngine(),n){let t={x:50,y:50};yield this.particlesService.loadPolygonParticles("tsparticles-login-bg","assets/icons/unajlogo.svg",t,.5)}else{let t={x:50,y:50};yield this.particlesService.loadPolygonParticles("tsparticles-login-bg","assets/icons/unajlogo.svg",t,1.2)}}catch{}})}onSubmit(){this.submitted=!0,!this.loginForm.invalid&&(this.loading=!0,this.errorMessage="",this.authService.login(this.loginForm.value).subscribe({next:n=>{this.loading=!1;let t=typeof n.user.role=="string"?n.user.role:n.user.role?.nombre;t==="admin"?this.router.navigate(["/app/admin"]):t==="gestor-ubicaciones"?this.router.navigate(["/app/admin/ubicacion"]):t==="personal"?this.router.navigate(["/app/personal/dashboard"]):t==="estudiante"?this.router.navigate(["/app/estudiante/dashboard"]):this.router.navigate(["/app"])},error:n=>{this.loading=!1,this.errorMessage=n.error?.message||"Error al iniciar sesi\xF3n. Por favor, verifica tus credenciales."}}))}get identifier(){return this.loginForm.get("identifier")}get password(){return this.loginForm.get("password")}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=C({type:o,selectors:[["app-login"]],hostBindings:function(t,m){t&1&&u("resize",function(h){return m.onResize(h)},x)},decls:13,vars:0,consts:[[1,"login-container"],["styleClass","full-screen-card"],[1,"container-shape","one"],[1,"shape","one"],[1,"container-shape","two"],[1,"shape","two"],[1,"container-shape","three","right"],[1,"shape","three","right"],[1,"container-shape","four","right"],[1,"shape","four","right"],[1,"container-shape","five","right"],[1,"shape","five","right"],["pTemplate","content"],[1,"card-content-wrapper"],[1,"particles-section"],["id","tsparticles-login-bg",1,"particles-background"],[1,"login-layout"],[1,"form-section"],[1,"text-center","mb-8"],[1,"text-4xl","font-bold","mb-2",2,"color","#0D2A72"],[1,"text-lg",2,"color","#1a3d8f"],[1,"form-container"],[1,"logo-mini-container"],["src","assets/icons/unajlogo-mini.svg","alt","UNAJ Logo",1,"logo-mini"],[1,"space-y-6",3,"ngSubmit","formGroup"],["severity","error","styleClass","w-full",3,"text",4,"ngIf"],[1,"field"],["for","identifier",1,"block","text-sm","font-semibold","mb-2",2,"color","#1f2937"],[1,"p-input-icon-left","w-full"],[1,"pi","pi-user"],["pInputText","","id","identifier","formControlName","identifier","placeholder","Ingresa tu email o DNI","autocomplete","username",1,"w-full"],["class","mt-1 block","style","color: #dc2626;",4,"ngIf"],["for","password",1,"block","text-sm","font-semibold","mb-2",2,"color","#1f2937"],[1,"p-input-icon-left","w-full","password-wrapper"],[1,"pi","pi-lock"],["id","password","formControlName","password","placeholder","Ingresa tu contrase\xF1a","styleClass","w-full","inputStyleClass","w-full","autocomplete","current-password",3,"toggleMask","feedback"],["type","submit","label","Iniciar Sesi\xF3n","icon","pi pi-sign-in","styleClass","w-full",3,"loading","disabled"],[1,"text-center","text-sm","mt-4",2,"color","#1f2937"],["target","_blank","rel","noopener noreferrer",2,"color","#F4B41A","font-weight","600","text-decoration","none","cursor","pointer",3,"href"],["severity","error","styleClass","w-full",3,"text"],[1,"mt-1","block",2,"color","#dc2626"],[4,"ngIf"]],template:function(t,m){t&1&&(i(0,"div",0)(1,"p-card",1)(2,"div",2),s(3,"div",3),e(),i(4,"div",4),s(5,"div",5),e(),i(6,"div",6),s(7,"div",7),e(),i(8,"div",8),s(9,"div",9),e(),i(10,"div",10),s(11,"div",11),e(),p(12,ot,35,9,"ng-template",12),e()())},dependencies:[y,P,j,L,I,D,F,z,T,B,R,S,G,A,W,q,U,H,$,Y],styles:['.login-container[_ngcontent-%COMP%]{width:100%;min-height:100vh;overflow:hidden;position:relative}.card-content-wrapper[_ngcontent-%COMP%]{position:relative;min-height:100vh;display:flex;flex-direction:column}@media (min-width: 1200px){.card-content-wrapper[_ngcontent-%COMP%]{flex-direction:row-reverse}}.particles-section[_ngcontent-%COMP%]{position:relative;height:30vh}@media (min-width: 1200px){.particles-section[_ngcontent-%COMP%]{flex:1.4;height:100vh}}.login-layout[_ngcontent-%COMP%]{position:relative;z-index:10;display:flex;flex-direction:column;justify-content:flex-start;flex:1}@media (min-width: 1200px){.login-layout[_ngcontent-%COMP%]{flex:1;justify-content:center;min-height:100vh}}.form-section[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:.5rem 2rem 2rem;position:relative}@media (min-width: 1200px){.form-section[_ngcontent-%COMP%]{justify-content:center;padding:2rem}}.particles-background[_ngcontent-%COMP%]{position:absolute!important;top:0;left:0;width:100%;height:100%;pointer-events:none}@media (min-width: 1025px){.mobile-header[_ngcontent-%COMP%]{display:none}}.logo-mini-container[_ngcontent-%COMP%]{display:none}@media (min-width: 1025px){.logo-mini-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:2rem}}.logo-mini[_ngcontent-%COMP%]{max-width:150px;height:auto}.form-container[_ngcontent-%COMP%]{width:100%;max-width:450px;background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;padding:2.5rem;box-shadow:0 8px 32px #0d2a7266;border:2px solid #052795}@media (min-width: 1025px){.form-container[_ngcontent-%COMP%]{padding:3rem 2.5rem;min-height:500px;display:flex;flex-direction:column;justify-content:center}}[_nghost-%COMP%]     .full-screen-card{width:100vw!important;height:100vh!important;border-radius:0!important;margin:0!important;background:#fff!important;position:relative;overflow:hidden}[_nghost-%COMP%]     .full-screen-card .p-card-body{padding:0!important;height:100%}[_nghost-%COMP%]     .full-screen-card .p-card-content{padding:0!important;height:100%}[_nghost-%COMP%]     .p-password{width:100%}[_nghost-%COMP%]     .p-inputtext{background:#fff!important;border:2px solid #e5e7eb!important;color:#1f2937!important;box-shadow:0 8px 32px #0d2a7266}[_nghost-%COMP%]     .p-inputtext:focus{border-color:#052795!important;box-shadow:0 0 0 .2rem #7886cf40!important;background:#fefefe!important}[_nghost-%COMP%]     .p-password-input{background:#fff!important;border:2px solid #e5e7eb!important;color:#1f2937!important}[_nghost-%COMP%]     .p-password-input:focus{border-color:#f4b41a!important;box-shadow:0 0 0 .2rem #f4b41a40!important;background:#fff!important}[_nghost-%COMP%]     .p-button{background:linear-gradient(135deg,#e7c35b 0% 100%)!important;border:none!important;font-weight:700;padding:.75rem 1.5rem;transition:all .3s ease;color:#0d2a72!important;font-size:1rem;width:100%;justify-content:center}[_nghost-%COMP%]     .p-button:hover{background:linear-gradient(135deg,#f7c347,#f4b41a)!important;transform:translateY(-2px);box-shadow:0 6px 20px #f4b41a80}[_nghost-%COMP%]     .p-button:active{transform:translateY(0)}[_nghost-%COMP%]     .field{display:flex;flex-direction:column;margin-bottom:1.5rem}[_nghost-%COMP%]     .field label{order:1;margin-bottom:.5rem}[_nghost-%COMP%]     .field .p-input-icon-left, [_nghost-%COMP%]     .field .p-password{order:2}[_nghost-%COMP%]     .field small{order:3;margin-top:.25rem}[_nghost-%COMP%]     .p-message{margin-bottom:1rem}[_nghost-%COMP%]     a[href^="https://wa.me/"]{transition:all .2s ease}[_nghost-%COMP%]     a[href^="https://wa.me/"]:hover{color:#e09f0a!important;text-decoration:underline!important}[_nghost-%COMP%]     .p-input-icon-left{position:relative;display:block;width:100%}[_nghost-%COMP%]     .p-input-icon-left>i{position:absolute;left:.75rem;top:50%;transform:translateY(-50%);color:#1a3d8f;z-index:1}[_nghost-%COMP%]     .p-input-icon-left>input{width:100%!important;padding-left:2.5rem!important}[_nghost-%COMP%]     .password-wrapper{position:relative}[_nghost-%COMP%]     .password-wrapper>i{position:absolute;left:.75rem;top:50%;transform:translateY(-50%);color:#1a3d8f;z-index:3}[_nghost-%COMP%]     .password-wrapper .p-password{width:100%}[_nghost-%COMP%]     .password-wrapper .p-password input{padding-left:2.5rem!important}[_nghost-%COMP%]     .p-password{position:relative;display:block}[_nghost-%COMP%]     .p-password .p-password-input{padding-right:2.5rem!important;width:100%!important}[_nghost-%COMP%]     .p-password .p-password-panel{position:relative}[_nghost-%COMP%]     .p-password .p-password-toggle-mask, [_nghost-%COMP%]     .p-password button[type=button]{position:absolute!important;right:.5rem!important;top:0!important;bottom:0!important;height:100%!important;width:2.5rem!important;background:transparent!important;border:none!important;padding:0!important;margin:0!important;display:flex!important;align-items:center!important;justify-content:center!important;z-index:2!important}[_nghost-%COMP%]     .p-password .p-password-toggle-mask:hover, [_nghost-%COMP%]     .p-password button[type=button]:hover{background:transparent!important}[_nghost-%COMP%]     .p-password .p-password-toggle-mask:focus, [_nghost-%COMP%]     .p-password button[type=button]:focus{outline:none!important;box-shadow:none!important}[_nghost-%COMP%]     .p-password .p-icon, [_nghost-%COMP%]     .p-password svg{color:#1a3d8f!important;width:1.25rem!important;height:1.25rem!important}[_nghost-%COMP%]     .p-password input{height:2.75rem!important}@media (min-width: 768px){.container-shape[_ngcontent-%COMP%]{position:absolute;filter:drop-shadow(5px -5px 6px rgba(0,0,0,.4));z-index:1}.container-shape.right[_ngcontent-%COMP%]{filter:drop-shadow(-5px -5px 6px rgba(0,0,0,.4))}.shape[_ngcontent-%COMP%]{background:#30bce1;transform:rotate(19deg)}.shape.right[_ngcontent-%COMP%]{background:#2c3b95b3;transform:rotate(-11deg)}.container-shape.one[_ngcontent-%COMP%]{top:6.3%;left:26.1%}.container-shape.two[_ngcontent-%COMP%]{top:56.4%;left:13.6%}.container-shape.three[_ngcontent-%COMP%]{top:6.55%;left:67.6%}.container-shape.four[_ngcontent-%COMP%]{top:17.79%;left:86.9%}.container-shape.five[_ngcontent-%COMP%]{top:51.5%;left:75.3%}.shape.one[_ngcontent-%COMP%]{-webkit-clip-path:polygon(38% 0%,100% 37%,100% 100%,37% 100%,0% 37%);clip-path:polygon(38% 0%,100% 37%,100% 100%,37% 100%,0% 37%);width:3vw;height:5vh}.shape.two[_ngcontent-%COMP%]{-webkit-clip-path:polygon(39% 0%,100% 38%,99% 100%,37% 100%,0% 38%);clip-path:polygon(39% 0%,100% 38%,99% 100%,37% 100%,0% 38%);width:11vw;height:16vh}.shape.three[_ngcontent-%COMP%]{-webkit-clip-path:polygon(56% 0%,100% 39%,69% 100%,8% 100%,0% 37%);clip-path:polygon(56% 0%,100% 39%,69% 100%,8% 100%,0% 37%);width:4vw;height:7vh}.shape.four[_ngcontent-%COMP%]{-webkit-clip-path:polygon(56% 0%,100% 38%,70% 100%,8% 99%,0% 37%);clip-path:polygon(56% 0%,100% 38%,70% 100%,8% 99%,0% 37%);width:6vw;height:10vh}.shape.five[_ngcontent-%COMP%]{-webkit-clip-path:polygon(57% 0%,100% 38%,70% 100%,8% 100%,0% 38%);clip-path:polygon(57% 0%,100% 38%,70% 100%,8% 100%,0% 38%);width:13vw;height:21vh}}']})};export{J as LoginComponent};
